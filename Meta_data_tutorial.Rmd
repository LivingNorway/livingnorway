---
title: "Adding metadata in Rmarkdown"
author: "Matt"
output: 
  distill::distill_article:
    self_contained: FALSE
---

## Setting up the metadata in RMarkdown

Adding metadata can often be an afterthought. In the {LivingNorwayR} package we have provided a template and a few functions that allow you to develop the metadata at the start of the project. The metadata require a realtively large input from the user as many of the components require some form of free text input. We have tried to reduce the amount of effort required to input the metadata and provided a few functions that will help if needed. This document can be formatted as a data paper or data story, as long as the code blocks that are part of the metadata template are retained then you can add new code blocks or text. I will demonstrate some of the possibilities in this tutorial. 


The first code block in the metadata template is code to set up the markdown and also to allow {LivingNorwayR} functions to find the metadata terms that have been used. 

```{r Set up, echo=TRUE, warning=FALSE, message=FALSE}
#PLEASE DO NOT DELETE THIS FUNCTION
#fmt="html_output"
fmt <- rmarkdown::default_output_format(knitr::current_input())$name
knitr::opts_chunk$set(echo = TRUE)


```


```{r, echo=FALSE}
library(LivingNorwayData)
library(LivingNorwayR)
library(tidyverse)
library(tippy)
library(leaflet)
library(knitr)

```

We will use the "Rock_ptarmigan" dataset found in the {LivingNorwayData} package. This dataset comes with metadata ("LivingNorwayData\data-raw\DwC_ptarmigan\dataset") in the xml format. Here we will use this dataset to demonstrate how one can create metadata using the {LivingNorway} package. 


```{r call in your dataset}
ptar<-LivingNorwayData::Rock_ptarmigan

ptar %>% 
  select(1:6) %>% 
  head()
```

In the metadata template we have added in code for the user to adapt to their own data. Not all of the components of the metadata need to be included and others can be added if needed. We have <u class="dotted">`r tippy("commented out","<span style='font-size:14px;'>'added a # infront of the code so that R does not read and execute it'</span>")`</u> the code that sends the metadata to be converted to xml. For each element that you use you can put the code 'inline' so that you can write a human readable document. 

First we can look at each of the metadata elements in turn and then we will demonstrate how to make use of these usining Markdown's inline code feature.


## The metadata elements 

The first set of metadata are about the dataset. These include the following elements:

<u class="dotted">`r tippy("alternateIdentifier","<span style='font-size:14px;'>'It is a Universally Unique Identifier (UUID) for the EML document and not for the dataset. This term is optional. A list of different identifiers can be supplied. E.g., 619a4b95-1a82-4006-be6a-7dbe3c9b33c5.'</span>")`</u> We can use the function from the {uuid} package UUIDgenerate() to create a Universally unique identifier or if we have one already use that. 

```{r alternateIdentifier,results = 'hide' }
alternateIdentifier<-"10.15468/o4zcd3"
alternateIdentifier<-LivingNorwayR::add_tag(tagtype = "alternateIdentifier", txt=alternateIdentifier)

```

<u class="dotted">`r tippy("title","<span style='font-size:14px;'>'A description of the resource that is being documented that is long enough to differentiate it from other similar resources. Multiple titles may be provided, particularly when trying to express the title in more than one language (use the xml:lang attribute to indicate the language if not English/en). E.g. Vernal pool amphibian density data, Isla Vista, 1990-1996.'</span>")`</u>

```{r title, results = 'hide'}
title="Rock ptarmigan (Lagopus muta) radio telemetry in Lierne, Norway" #

title<-LivingNorwayR::add_tag(tagtype = "title", txt=title)
```

Then the next set deal with the dataset creators and owners: 

<u class="dotted">`r tippy("creator","<span style='font-size:14px;'>'The resource creator is the person or organization responsible for creating the resource itself.'</span>")`</u> The creator can be an individual and/or an organisation. The creator has some nested elements - for example the individual name, the organisation name, etc.

```{r creator, results = 'hide'}
#creator1
givenName1<-"Erlend B."
givenName1<-LivingNorwayR::add_tag(tagtype = "givenName", txt=givenName1)
surName1<-"Nilsen"
surName1<-LivingNorwayR::add_tag(tagtype = "surName", txt=surName1)

individualName1<-LivingNorwayR::add_tag(tagtype = "individualName", txt=list(givenName1,surName1))
organisationName1<-"Norwgian Institute for Nature Researech (NINA)"
organisationName1<-LivingNorwayR::add_tag(tagtype = "organisationName", txt=organisationName1)
positionName1<-"Senior Research Scientist"
positionName1<-LivingNorwayR::add_tag(tagtype = "positionName", txt=positionName1)
deliveryPoint1<-"Norwegian Institute for Nature Research"
city1<-"Trondheim"
postalCode1<-"7485"
country1<-"NORWAY"

deliveryPoint1<-LivingNorwayR::add_tag(tagtype = "deliveryPoint", txt=deliveryPoint1)
city1<-LivingNorwayR::add_tag(tagtype = "city", txt=city1)
postalCode1<-LivingNorwayR::add_tag(tagtype = "postalCode", txt=postalCode1)
country1<-LivingNorwayR::add_tag(tagtype = "country", txt=country1)

address1<-LivingNorwayR::add_tag(tagtype = "address", txt=list(deliveryPoint1,city1,postalCode1,country1))
electronicMailAddress1<-"erlend.nilsen@nina.no"
electronicMailAddress1<-LivingNorwayR::add_tag(tagtype = "electronicMailAddress", txt=electronicMailAddress1)

creator1=LivingNorwayR::add_tag(tagtype = "creator", txt=list(individualName1, organisationName1, positionName1,address1, electronicMailAddress1))

#creator2
givenName2<-"Hans Chr."
givenName2<-LivingNorwayR::add_tag(tagtype = "givenName", txt=givenName2)
surName2<-"Pedersen"
surName2<-LivingNorwayR::add_tag(tagtype = "surName", txt=surName2)

individualName2<-LivingNorwayR::add_tag(tagtype = "individualName", txt=list(givenName2,surName2))
organisationName2<-"Norwgian Institute for Nature Researech (NINA)"
organisationName2<-LivingNorwayR::add_tag(tagtype = "organisationName", txt=organisationName2)
positionName2<-"Senior Research Scientist"
positionName2<-LivingNorwayR::add_tag(tagtype = "positionName", txt=positionName2)
deliveryPoint2<-"Norwegian Institute for Nature Research"
city2<-"Trondheim"
postalCode2<-"7485"
country2<-"NORWAY"

deliveryPoint2<-LivingNorwayR::add_tag(tagtype = "deliveryPoint", txt=deliveryPoint2)
city2<-LivingNorwayR::add_tag(tagtype = "city", txt=city2)
postalCode2<-LivingNorwayR::add_tag(tagtype = "postalCode", txt=postalCode2)
country2<-LivingNorwayR::add_tag(tagtype = "country", txt=country2)

address2<-LivingNorwayR::add_tag(tagtype = "address", txt=list(deliveryPoint2,city2,postalCode2,country2))
electronicMailAddress2<-"hans.pedersen@nina.no"
electronicMailAddress2<-LivingNorwayR::add_tag(tagtype = "electronicMailAddress", txt=electronicMailAddress2)

creator2=LivingNorwayR::add_tag(tagtype = "creator", txt=list(individualName2, organisationName2, positionName2,address2, electronicMailAddress2))

#creator3
givenName3<-"Henrik"
givenName3<-LivingNorwayR::add_tag(tagtype = "givenName", txt=givenName3)
surName3<-"Broseth"
surName3<-LivingNorwayR::add_tag(tagtype = "surName", txt=surName3)

individualName3<-LivingNorwayR::add_tag(tagtype = "individualName", txt=list(givenName3,surName3))
organisationName3<-"Norwgian Institute for Nature Researech (NINA)"
organisationName3<-LivingNorwayR::add_tag(tagtype = "organisationName", txt=organisationName3)
positionName3<-"Senior Research Scientist"
positionName3<-LivingNorwayR::add_tag(tagtype = "positionName", txt=positionName3)
deliveryPoint3<-"Norwegian Institute for Nature Research"
city3<-"Trondheim"
postalCode3<-"7485"
country3<-"NORWAY"

deliveryPoint3<-LivingNorwayR::add_tag(tagtype = "deliveryPoint", txt=deliveryPoint3)
city3<-LivingNorwayR::add_tag(tagtype = "city", txt=city3)
postalCode3<-LivingNorwayR::add_tag(tagtype = "postalCode", txt=postalCode3)
country3<-LivingNorwayR::add_tag(tagtype = "country", txt=country3)

address3<-LivingNorwayR::add_tag(tagtype = "address", txt=list(deliveryPoint3,city3,postalCode3,country3))
electronicMailAddress3<-"henrik.broseth@nina.no"
electronicMailAddress3<-LivingNorwayR::add_tag(tagtype = "electronicMailAddress", txt=electronicMailAddress3)

creator3=LivingNorwayR::add_tag(tagtype = "creator", txt=list(individualName3, organisationName3, positionName3,address3, electronicMailAddress3))


#creator4
givenName4<-"Paal F."
givenName4<-LivingNorwayR::add_tag(tagtype = "givenName", txt=givenName4)
surName4<-"Moa"
surName4<-LivingNorwayR::add_tag(tagtype = "surName", txt=surName4)

individualName4<-LivingNorwayR::add_tag(tagtype = "individualName", txt=list(givenName4,surName4))
organisationName4<-"Nord University"
organisationName4<-LivingNorwayR::add_tag(tagtype = "organisationName", txt=organisationName4)
positionName4<-"Senior Lecturer"
positionName4<-LivingNorwayR::add_tag(tagtype = "positionName", txt=positionName4)
country4<-"NORWAY"

country4<-LivingNorwayR::add_tag(tagtype = "country", txt=country4)

address4<-LivingNorwayR::add_tag(tagtype = "address", txt=list(country4))
electronicMailAddress4<-"paal.f.moa@nord.no"
electronicMailAddress4<-LivingNorwayR::add_tag(tagtype = "electronicMailAddress", txt=electronicMailAddress4)

creator4=LivingNorwayR::add_tag(tagtype = "creator", txt=list(individualName4, organisationName4, positionName4,address4, electronicMailAddress4))

```


<u class="dotted">`r tippy("metadataProvider","<span style='font-size:14px;'>'The metadataProvider is the person or organization responsible for providing documentation for the resource. See section “People and Organisations” for more details.'</span>")`</u>

```{r metadataProvider, results = 'hide'}
#metadataProvider1
userid1<-"http://orcid.org/0000-0002-5119-8331"
LivingNorwayR::add_tag(tagtype = "userid", txt=userid1)
metadataProvider1<-add_tag(tagtype = "metadataProvider", txt=list(individualName1, organisationName1, positionName1, address1, userid1))

givenName5<-"Roald"
surName5<-"Vang"
individualName5<-LivingNorwayR::add_tag(tagtype = "individualName", txt=list(givenName5,surName5))
electronicMailAddress5<-"rv@nina.no"
electronicMailAddress5<-LivingNorwayR::add_tag(tagtype = "electronicMailAddress", txt=electronicMailAddress5)
metadataProvider2<-add_tag(tagtype = "metadataProvider", txt=list(individualName5, organisationName1, address1))

```


Following this the next set of elements looks at the data itself:

<u class="dotted">`r tippy("pubDate","<span style='font-size:14px;'>'The date that the resource was published. The format should be represented as: CCYY, which represents a 4 digit year, or as CCYY-MM-DD, which denotes the full year, month, and day. Note that month and day are optional components. Formats must conform to ISO 8601. E.g. 2010-09-20.'</span>")`</u>

```{r pubDate, results = 'hide'}
pubDate="2019-09-17"
pubDate<-LivingNorwayR::add_tag(tagtype = "pubDate", txt=pubDate)

```


<u class="dotted">`r tippy("language","<span style='font-size:14px;'>'The language in which the resource (not the metadata document) is written. This can be a well-known language name, or one of the ISO language codes to be more precise. GBIF recommendation is to use the ISO language code (http://vocabularies.gbif.org/vocabularies/lang). E.g., English.'</span>")`</u>


```{r language, results = 'hide'}
language<-"ENGLISH"
language<-LivingNorwayR::add_tag(tagtype = "language", txt=language)

```


<u class="dotted">`r tippy("abstract","<span style='font-size:14px;'>'A brief overview of the resource that is being documented.'</span>")`</u>

```{r abstract, results = 'hide'}
abstract<-"This data set is based on a small radio telemetry project on rock ptarmigan (Lagopus muta) in Lierne municipality, central Norway. In total, 85 rock ptarmigans were captured and radio-collared. After release, the birds were re-located with variable geographical precision (noted in the data). When mortality were detected, cause of death was as far as possible recorded.In the published data, cause of death is attributed to one of two causes (hunting OR other causes), and this information is available in the field 'dynamicProperties'; together with information about the event (capture OR radiotelemetry/recature). In some cases more detailed information about the event and state is available in the raw data."

abstract<-LivingNorwayR::add_tag(tagtype = "abstract", txt=abstract)


```


<u class="dotted">`r tippy("keyword","<span style='font-size:14px;'>'A keyword or key phrase that concisely describes the resource or is related to the resource. Each keyword field should contain one and only one keyword (i.e., keywords should not be separated by commas or other delimiters). E.g., biodiversity.'</span>")`</u>

```{r keywords, results = 'hide'}
keyword1<-"Occurrence"
keyword1<-LivingNorwayR::add_tag(tagtype = "keyword", txt=keyword1)

```

<u class="dotted">`r tippy("keywordThesaurus","<span style='font-size:14px;'>'The name of the official keyword thesaurus from which keyword was derived. If an official thesaurus name does not exist, please keep a placeholder value such as “N/A” instead of removing this element as it is required together with the keyword element to constitute a keywordSet. E.g., IRIS keyword thesaurus.'</span>")`</u>

```{r keywordThesaurus, results = 'hide'}
keywordThesaurus1<-"GBIF Dataset Type Vocabulary: http://rs.gbif.org/vocabulary/gbif/dataset_type.xml"
keywordThesaurus1<-LivingNorwayR::add_tag(tagtype = "keywordThesaurus", txt=keywordThesaurus1)


```

These become a "keywordSet":

```{r, results = 'hide'}
keywordSet1<-LivingNorwayR::add_tag(tagtype = "keywordSet", txt=list(keyword1, keywordThesaurus1))

```

For other keywords:

```{r, results = 'hide'}
keyword2<-"Observation"
keyword2<-LivingNorwayR::add_tag(tagtype = "keyword", txt=keyword2)
keywordThesaurus2<-"GBIF Dataset Subtype Vocabulary: http://rs.gbif.org/vocabulary/gbif/dataset_subtype.xml"
keywordThesaurus2<-LivingNorwayR::add_tag(tagtype = "keywordThesaurus", txt=keywordThesaurus2)
keywordSet2<-LivingNorwayR::add_tag(tagtype = "keywordSet", txt=list(keyword2, keywordThesaurus2))


```


<u class="dotted">`r tippy("intellectualRights","<span style='font-size:14px;'>'A rights management statement for the resource, or reference a service providing such information. Rights information encompasses Intellectual Property Rights (IPR), Copyright, and various Property Rights. In the case of a data set, rights might include requirements for use, requirements for attribution, or other requirements the owner would like to impose. E.g., Copyright 2001 Regents of the University of California Santa Barbara. Free for use by all individuals provided that the owners are acknowledged in any use or publication.'</span>")`</u>


```{r intellectualRights, results = 'hide'}

intellectualRights<-"This work is licensed under a Creative Commons Attribution (CC-BY) 4.0 License " # might need restructuring http://creativecommons.org/licenses/by/4.0/legalcode

intellectualRights<-LivingNorwayR::add_tag(tagtype = "intellectualRights", txt=intellectualRights)

```


Next we look at the taxonomic and geographic coverage of the dataset:

<u class="dotted">`r tippy("geographicDescription","<span style='font-size:14px;'>'A short text description of a dataset's geographic areal domain. A text description is especially important to provide a geographic setting when the extent of the dataset cannot be well described by the 'boundingCoordinates'. E.g., 'Manistee River watershed', extent of 7 1/2 minute quads containing any property belonging to Yellowstone National Park'</span>")`</u>

```{r graphicDescription, results = 'hide'}
geographicDescription<-"Study area mainly in central Norway (Lierne and Snåsa municipalities). Some re-locations of radio-collared ptarmigan in Sweden are included in the data set."
graphicDescription<-LivingNorwayR::add_tag(tagtype = "geographicDescription", txt=geographicDescription)


```


<u class="dotted">`r tippy("westBoundingCoordinate","<span style='font-size:14px;'>'Subfield of boundingCoordinates field covering the W margin of a bounding box. The longitude in decimal degrees of the western-most point of the bounding box that is being described. E.g., -18.25, +25, 45.24755.'</span>")`</u>

<u class="dotted">`r tippy("eastBoundingCoordinate","<span style='font-size:14px;'>'Subfield of boundingCoordinates field covering the E margin of a bounding box. The longitude in decimal degrees of the eastern-most point of the bounding box that is being described. E.g., -18.25, +25, 45.24755.'</span>")`</u>

<u class="dotted">`r tippy("northBoundingCoordinate","<span style='font-size:14px;'>'Subfield of boundingCoordinates field covering the N margin of a bounding box. The longitude in decimal degrees of the northern-most point of the bounding box that is being described. E.g., -18.25, +25, 65.24755.'</span>")`</u>

<u class="dotted">`r tippy("southBoundingCoordinate","<span style='font-size:14px;'>'Subfield of boundingCoordinates field covering the S margin of a bounding box. The longitude in decimal degrees of the southern-most point of the bounding box that is being described. E.g., -118.25, +25, 84.24755.'</span>")`</u>

For these coordinates we can use a function from the {LivingNorwayR} package to help us. We first need to convert the "," to "." using dplyr::mutate. 

```{r bounding box, results = 'hide'}
df<-ptar %>% 
  mutate(X.koordinat=gsub(",",".",X.koordinat)) %>%
  mutate(Y.koordinat=gsub(",",".",Y.koordinat))
#LivingNorwayR::get_geographic_extent(df,"X.koordinat", "Y.koordinat")
coords<-LivingNorwayR::get_NOR_geographic_extent(df, "X.koordinat", "Y.koordinat",Code = 3045, add_map = "no")

westBoundingCoordinate<-coords[1]
westBoundingCoordinate<-LivingNorwayR::add_tag(tagtype = "westBoundingCoordinate", txt=westBoundingCoordinate)
eastBoundingCoordinate<-coords[3]
eastBoundingCoordinate<-LivingNorwayR::add_tag(tagtype = "eastBoundingCoordinate", txt=eastBoundingCoordinate)
northBoundingCoordinate<-coords[4]
northBoundingCoordinate<-LivingNorwayR::add_tag(tagtype = "northBoundingCoordinate", txt=northBoundingCoordinate)
southBoundingCoordinate<-coords[2]
southBoundingCoordinate<-LivingNorwayR::add_tag(tagtype = "southBoundingCoordinate", txt=southBoundingCoordinate)

boundingCoordinates<-LivingNorwayR::add_tag(tagtype = "boundingCoordinates", txt = list(westBoundingCoordinate, eastBoundingCoordinate, northBoundingCoordinate, southBoundingCoordinate))
geographicCoverage<-LivingNorwayR::add_tag(tagtype = "geographicCoverage", txt = list(geographicDescription, boundingCoordinates))

```

We can also use R functions to get the temporal coverage of the dataset:
     
<u class="dotted">`r tippy("beginDate","<span style='font-size:14px;'>'Subfield of rangeOfDates field: It may be used multiple times with a endDate field to document multiple date ranges. A single time stamp signifying the beginning of some time period. The calendar date field is used to express a date, giving the year, month, and day. The format should be one that complies with the International Standards Organization's standard 8601. The recommended format for EML is YYYY-MM-DD, where Y is the four digit year, M is the two digit month code (01 - 12, where January = 01), and D is the two digit day of the month (01 - 31). This field can also be used to enter just the year portion of a date. E.g. 2010-09-20'</span>")`</u>

<u class="dotted">`r tippy("endDate","<span style='font-size:14px;'>'Subfield of rangeOfDates field: It may be used multiple times with a beginDate field to document multiple date ranges. A single time stamp signifying the end of some time period. The calendar date field is used to express a date, giving the year, month, and day. The format should be one that complies with the International Standards Organization's standard 8601. The recommended format for EML is YYYY-MM-DD, where Y is the four digit year, M is the two digit month code (01 - 12, where January = 01), and D is the two digit day of the month (01 - 31). This field can also be used to enter just the year portion of a date. E.g. 2010-09-20.'</span>")`</u>

<u class="dotted">`r tippy("singleDateTime","<span style='font-size:14px;'>'The SingleDateTime field is intended to describe a single date and time for an event.'</span>")`</u>

```{r temporalCoverage, results = 'hide'}

dates<-as.POSIXct(ptar$Dato,format="%d.%m.%Y %H.%M.%S") #defining the original format of your date
(LivingNorwayR::get_temporal_cover(dates)) # I think I will change this function to allow easier use 
calenderDate1<-"2012-02-14"
calenderDate2<-"2014-09-17"

calenderDate1<-LivingNorwayR::add_tag(tagtype = "calenderDate", txt=calenderDate1)
calenderDate2<-LivingNorwayR::add_tag(tagtype = "calenderDate", txt=calenderDate2)

beginDate<-LivingNorwayR::add_tag(tagtype = "beginDate", txt=list(calenderDate1))
endDate<-LivingNorwayR::add_tag(tagtype = "endDate", txt=list(calenderDate2))

rangeOfDates<-LivingNorwayR::add_tag(tagtype = "rangeOfDates", txt=list(beginDate,endDate))

temporalCoverage<-LivingNorwayR::add_tag(tagtype = "temporalCoverage", txt=list(rangeOfDates))


```


<u class="dotted">`r tippy("taxonomicClassification","<span style='font-size:14px;'>'Information about the range of taxa addressed in the dataset or collection.'</span>")`</u>

<u class="dotted">`r tippy("taxonRankName","<span style='font-size:14px;'>'The name of the taxonomic rank for which the Taxon rank value is provided. E.g., phylum, class, genus, species.'</span>")`</u>

<u class="dotted">`r tippy("taxonRankValue","<span style='font-size:14px;'>'The name representing the taxonomic rank of the taxon being described. E.g. Acer would be an example of a genus rank value, and rubrum would be an example of a species rank value, together indicating the common name of red maple. It is recommended to start with Kingdom and include ranks down to the most detailed level possible.'</span>")`</u>

<u class="dotted">`r tippy("commonName","<span style='font-size:14px;'>'Applicable common names; these common names may be general descriptions of a group of organisms if appropriate. E.g., invertebrates, waterfowl.'</span>")`</u>


```{r TaxonmicCoverage, results = 'hide'}

taxonRankName<-"Species"
taxonRankValue<-"Lagopus muta"
commonName<-"Rock ptarmigan"
taxonRankName<-LivingNorwayR::add_tag(tagtype = "taxonRankName", txt=taxonRankName)
taxonRankValue<-LivingNorwayR::add_tag(tagtype = "taxonRankValue", txt=taxonRankValue)
commonName<-LivingNorwayR::add_tag(tagtype = "commonName", txt=commonName)
taxonomicClassification<-LivingNorwayR::add_tag(tagtype = "taxonomicClassification", txt=list(taxonRankName, taxonRankValue, commonName))
taxonomicCoverage<-LivingNorwayR::add_tag(tagtype = "taxonomicCoverage", txt=list(taxonomicClassification))

```

We can wrap all this together in the coverage element:

```{r, results = 'hide'}
coverage<-LivingNorwayR::add_tag(tagtype = "coverage", txt=list(geographicCoverage, temporalCoverage,taxonomicCoverage))
```


The next section is about who is responsible for maintence of the data and how often it will be updated:


<u class="dotted">`r tippy("maintenace","<span style='font-size:14px;'>'The individual or organisation responsible for the maintence of the data resource'</span>")`</u>


```{r maintenance, results = 'hide'}
maintenanceUpdateFrequency<-"asNeeded"
maintenanceUpdateFrequency<-LivingNorwayR::add_tag(tagtype = "maintenanceUpdateFrequency",txt=maintenanceUpdateFrequency)
maintenance<-LivingNorwayR::add_tag(tagtype = "maintenance",txt=list(maintenanceUpdateFrequency))

```


<u class="dotted">`r tippy("contact","<span style='font-size:14px;'>'The contact field contains contact information for this dataset. This is the person or institution to contact with questions about the use, interpretation of a data set.'</span>")`</u>


```{r contact, results = 'hide'}

contact1<-LivingNorwayR::add_tag(tagtype = "contact", txt=list(individualName1,organisationName1, positionName1,address1,electronicMailAddress1, userid1))

contact2<-LivingNorwayR::add_tag(tagtype = "contact", txt=list(individualName5,organisationName1,address1,electronicMailAddress5))

```


Next we add data about the project and personnel:

<u class="dotted">`r tippy("project title","<span style='font-size:14px;'>'A descriptive title for the research project. E.g., Species diversity in Tennessee riparian habitats.'</span>")`</u>


<u class="dotted">`r tippy("personnel","<span style='font-size:14px;'>'The personnel field is used to document people involved in a research project by providing contact information and their role in the project.'</span>")`</u>

<u class="dotted">`r tippy("funding","<span style='font-size:14px;'>'The funding field is used to provide information about funding sources for the project such as: grant and contract numbers; names and addresses of funding sources.'</span>")`</u>

```{r project, results = 'hide'}

title<-"Rock ptarmigan (Lagopus muta) telemetry project in Lierne, Norway 2012-2014"
title<-LivingNorwayR::add_tag(tagtype = "title", txt=title)
role<-"PRINCIPAL_INVESTIGATOR"
role<-LivingNorwayR::add_tag(tagtype = "role", txt=role)
personnel1<-LivingNorwayR::add_tag(tagtype = "personnel", txt=list(individualName1, role ))
personnel2<-LivingNorwayR::add_tag(tagtype = "personnel", txt=list(individualName2, role ))
personnel3<-LivingNorwayR::add_tag(tagtype = "personnel", txt=list(individualName3, role ))
personnel4<-LivingNorwayR::add_tag(tagtype = "personnel", txt=list(individualName4, role ))
personnel5<-LivingNorwayR::add_tag(tagtype = "personnel", txt=list(individualName5, role ))
abstract<-"The purpose of the study was both to provide basic ecological knowledge about rock ptarmigan in Norway, and to assess the applicability and usefulness of a suite of field methods to study rock ptarmigan biology, demography and population dynamics. In addition to the radio-telemetry, pilot studies focusing on point-count studies and site-occupancy dynamics, as well as mark-recapture studies based on fecal DNA was preformed."
funding<-"The project was funded by a grant from the Norwegian Environment Agency (grant #12040045; Rock ptarmigan demography and population status). All handling of animals were in agreement with Norwegian laws, and approved by the Norwegian Food Safety Authority (approval ID 3960)."
descriptorname<-"generic"
citableClassificationSystem<-"false"
descriptorValue<-"The main study area was in Lierne municipality, Nord-TrÃ¸ndelag county, Norway. All capture of rock ptarmigan for the radio-telemetry study was conducted around Lierne National Park. Point-count studies and mark-recapture studies based on fecal DNA was performed at Lifjellet, Lierne, Norway."

personnel<-LivingNorwayR::add_tag(tagtype = "personnel", txt=list(personnel1,personnel2,personnel3,personnel4, personnel5))

studyAreaDescription<-LivingNorwayR::add_tag(tagtype = "studyAreaDescription", txt=list(descriptorname, descriptorValue))
project<-LivingNorwayR::add_tag(tagtype = "project", txt=list(title, personnel,abstract,funding,studyAreaDescription))


```

Finally we add the additional metadata:

<u class="dotted">`r tippy("dateStamp","<span style='font-size:14px;'>'The dateTime the metadata document was created or modified. E.g., 2002-10-23T18:13:51.235+01:00.'</span>")`</u>

<u class="dotted">`r tippy("citation","<span style='font-size:14px;'>'The citation for the work itself.'</span>")`</u>

<u class="dotted">`r tippy("bibliography","<span style='font-size:14px;'>'A list of citations that form a bibliography on literature related / used in the dataset.'</span>")`</u>

```{r additionalMetadata, results = 'hide'}
dateStamp="2020-09-24T08:55:53"
dateStamp<-LivingNorwayR::add_tag(tagtype = "dateStamp", txt=dateStamp)
citation="Nilsen E B, Pedersen H C, BrÃ¸seth H, Moa P F, Vang R (2019). Rock ptarmigan (Lagopus muta) radio telemetry in Lierne, Norway. Version 1.2. Norwegian Institute for Nature Research. Occurrence dataset https://doi.org/10.15468/o4zcd3 accessed via GBIF.org on 2020-09-24."	
citation<-LivingNorwayR::add_tag(tagtype = "citation", txt=citation)
citationIdentifier<-"http://hdl.handle.net/11250/2379287"
citationIdentifier<-LivingNorwayR::add_tag(tagtype = "citationIdentifier", txt=citationIdentifier)
bibliography="Nilsen, E.B., Pedersen, H.C., BrÃ¸seth, H., Kleven, O., Moa, P.F. &amp; Hagen, B.R. 2015. Fjellrypeprosjektet i Lierne: Ãrsrapport 2015. NINA Rapport 1217. 28 s"
bibliography<-LivingNorwayR::add_tag(tagtype = "bibliography", txt=list(bibliography, citationIdentifier))
gbif<-LivingNorwayR::add_tag(tagtype = "gbif", txt=list(dateStamp, citation,bibliography))

metadata<-LivingNorwayR::add_tag(tagtype = "metadata", txt=list(gbif))
additionalMetadata<-LivingNorwayR::add_tag(tagtype = "additionalMetadata", txt=list(metadata))

```


## Using the metadata template to write a data-paper or data-story

Here I will mirror the code in each section with the text ouput. You can either run the code directly in the inline code or in the code blocks so that named objects are created and then use the object name in the inline code.  

`` `r(LivingNorwayR::add_tag(tagtype ="title", txt="Rock ptarmigan (Lagopus muta) radio telemetry in Lierne, Norway")) ` ``

#  `r (LivingNorwayR::add_tag(tagtype ="title", txt="Rock ptarmigan (Lagopus muta) radio telemetry in Lierne, Norway"))`


This dataset (`` `r(LivingNorwayR::add_tag(tagtype = "alternateIdentifier", txt="10.15468/o4zcd3"))` ``) was created by:

* `` `r "\u0060r givenName1\u0060"` `` `` `r "\u0060r surName1\u0060"` ``
* `` `r "\u0060r givenName2\u0060"` `` `` `r "\u0060r surName2\u0060"` ``
* `` `r "\u0060r givenName3\u0060"` `` `` `r "\u0060r surName3\u0060"` ``
* `` `r "\u0060r givenName4\u0060"` `` `` `r "\u0060r surName4\u0060"` ``
* `` `r "\u0060r givenName5\u0060"` `` `` `r "\u0060r surName5\u0060"` ``

This dataset (`r (LivingNorwayR::add_tag(tagtype = "alternateIdentifier", txt="10.15468/o4zcd3"))`) was created by:

* `r givenName1` `r surName1` 
* `r givenName2` `r surName2` 
* `r givenName3` `r surName3` 
* `r givenName4` `r surName4` 
* `r givenName5` `r surName5` 

## Abstract

`` `r "\u0060r abstract\u0060"` ``

`r abstract`

## Keywords

 `` `r "\u0060r keyword1\u0060"` ``; `` `r "\u0060r keyword2\u0060"` ``


`r keyword1`; `r keyword2`

## Intellectual Rights

`` `r "\u0060r intellectualRights\u0060"` ``

`r intellectualRights`

## Geographic extent

`` `r "\u0060r geographicDescription\u0060"` ``


`r geographicDescription`

### Map the points

**You can use the functions in the {LivingNorwayR} package to produce data visualiations** 

```{r layout='l-screen-inset', fig.height=4, out.width='100%', fig.align='center'} 
df<-ptar %>% 
  mutate(X.koordinat=gsub(",",".",X.koordinat)) %>%
  mutate(Y.koordinat=gsub(",",".",Y.koordinat))
coords<-LivingNorwayR::get_NOR_geographic_extent(df, "X.koordinat", "Y.koordinat",Code = 3045, add_map = "yes")
coords[[2]]


```


* West bounding coordinate -  `` `r "\u0060r westBoundingCoordinate\u0060"` `` 
* East bounding coordinate -  `` `r "\u0060r eastBoundingCoordinate\u0060"` `` 
* North bounding coordinate -  `` `r "\u0060r northBoundingCoordinate\u0060"` `` 
* South bounding coordinate -  `` `r "\u0060r southBoundingCoordinate\u0060"` `` 

* West bounding coordinate -  `r westBoundingCoordinate`
* East bounding coordinate -  `r eastBoundingCoordinate`
* North bounding coordinate -  `r northBoundingCoordinate`
* South bounding coordinate -  `r southBoundingCoordinate`


## Temporal coverage

**Another function from the package allows you to get the range of dates for the Temporal coverage**

 `` `r "\u0060r (LivingNorwayR::get_temporal_cover(dates))\u0060"` `` 

`r (LivingNorwayR::get_temporal_cover(dates))`


## Taxonomic coverage

**If you use compound elements like coverage (see above) you can select the correct slot and use that in the inline code**

Taxonmic level: `` `r "\u0060r coverage[[3]][[1]][[1]]\u0060"` ``

Scientifc name: `` `r "\u0060r coverage[[3]][[1]][[2]]\u0060"` ``

Common name: `` `r "\u0060r coverage[[3]][[1]][[3]]\u0060"` ``


Taxonmic level: `r coverage[[3]][[1]][[1]]`

Scientifc name: `r coverage[[3]][[1]][[2]]`

Common name: `r coverage[[3]][[1]][[3]]`

## Project & people

Project title: `` `r "\u0060r project[[1]][1]\u0060"` ``

Project title: `r project[[1]][1]`

Principal Investigators: 
* `` `r "\u0060r personnel1[[1]][1] \u0060"` `` `` `r "\u0060r personnel1[[1]][2] \u0060"` ``
* `` `r "\u0060r personnel2[[1]][1] \u0060"` `` `` `r "\u0060r personnel2[[1]][2] \u0060"` ``
* `` `r "\u0060r personnel3[[1]][1] \u0060"` `` `` `r "\u0060r personnel3[[1]][2] \u0060"` ``
* `` `r "\u0060r personnel4[[1]][1] \u0060"` `` `` `r "\u0060r personnel4[[1]][2] \u0060"` ``
* `` `r "\u0060r personnel5[[1]][1] \u0060"` `` `` `r "\u0060r personnel5[[1]][2] \u0060"` ``

Principal Investigators: 
*  `r personnel1[[1]][1]` `r personnel1[[1]][2]`

*  `r personnel2[[1]][1]` `r personnel2[[1]][2]`

*  `r personnel3[[1]][1]` `r personnel3[[1]][2]`

*  `r personnel4[[1]][1]` `r personnel4[[1]][2]`

*  `r personnel5[[1]][1]` `r personnel5[[1]][2]`

Funding: `` `r "\u0060r funding \u0060"``

Funding: `r funding`




## Metadata provider

The metadata providers are:

 `` `r "\u0060r metadataProvider1[[1]][1]\u0060"` ``  `` `r "\u0060r metadataProvider1[[1]][2]\u0060"` `` 
 
 `` `r "\u0060r metadataProvider1[[3]][1]\u0060"` `` 
 
 `` `r "\u0060r metadataProvider1[[5]][1]\u0060"` `` 
 
 `` `r "\u0060r metadataProvider1[[2]][1]\u0060"` `` 
 
 `` `r "\u0060r metadataProvider1[[4]][2]\u0060"` `` 
 
  `` `r "\u0060r metadataProvider1[[4]][3]\u0060"` ``
  
 `` `r "\u0060r metadataProvider1[[4]][4]\u0060"` `` 
  
`` `r "\u0060r metadataProvider1[[4]][2]\u0060"` `` 

 ____
 

 `` `r "\u0060r metadataProvider1[[1]][1]\u0060"` ``  `` `r "\u0060r metadataProvider1[[1]][2]\u0060"` `` 
 
 `` `r "\u0060r metadataProvider1[[2]][1]\u0060"` `` 
 
 `` `r "\u0060r metadataProvider1[[3]][2]\u0060"` `` 
 
  `` `r "\u0060r metadataProvider1[[3]][3]\u0060"` ``
  
 `` `r "\u0060r metadataProvider1[[3]][4]\u0060"` `` 
  

The metadata providers are:
 
`r metadataProvider1[[1]][1]` `r metadataProvider1[[1]][2]`

`r metadataProvider1[[3]][1]`

`r metadataProvider1[[5]][1]`

`r metadataProvider1[[2]][1]`

`r metadataProvider1[[4]][2]`

`r metadataProvider1[[4]][3]`

`r metadataProvider1[[4]][4]`

___


`r metadataProvider2[[1]][1]` `r metadataProvider2[[1]][2]`

`r metadataProvider2[[2]][1]`

`r metadataProvider2[[3]][2]`

`r metadataProvider2[[3]][3]`

`r metadataProvider2[[3]][4]`




